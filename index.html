<!DOCTYPE html>
<html>
<head>
    <title>GTA 6</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
        }

        #menu {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #1a1a1a, #4a4a4a);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2;
            color: white;
        }

        #gameContainer {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
        }

        #gameCanvas {
            background: linear-gradient(#87CEEB, #4682B4);
        }

        #hud {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 24px;
            text-shadow: 2px 2px 2px black;
        }

        .button {
            padding: 15px 30px;
            font-size: 24px;
            background: #e74c3c;
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 20px;
        }

        .button:hover {
            background: #c0392b;
        }

        .title {
            font-size: 72px;
            text-shadow: 4px 4px 4px black;
            margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1 class="title">GTA 6</h1>
        <button class="button" onclick="startGame()">Играть</button>
    </div>

    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <div id="hud">
            Здоровье: <span id="health">100</span> | 
            Патроны: <span id="ammo">20</span>
        </div>
    </div>

    <script>
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameContainer');
        const healthSpan = document.getElementById('health');
        const ammoSpan = document.getElementById('ammo');
        const menu = document.getElementById('menu');
        let gameWidth = window.innerWidth;
        let gameHeight = window.innerHeight;
        
        // Настройка canvas
        canvas.width = gameWidth;
        canvas.height = gameHeight;
        gameContainer.appendChild(canvas);

        // Игровые переменные
        let player = {};
        let bullets = [];
        let enemies = [];
        let items = [];
        let keys = {};
        let animationFrame;

        function startGame() {
            menu.style.display = 'none';
            gameContainer.style.display = 'block';
            initGame();
            gameLoop();
        }

        function initGame() {
            player = {
                x: gameWidth/2,
                y: gameHeight/2,
                size: 40,
                speed: 8,
                health: 100,
                ammo: 20,
                angle: 0,
                pickupRadius: 60
            };

            bullets = [];
            enemies = [];
            items = [];
            
            // Создание врагов и предметов
            for(let i = 0; i < 7; i++) spawnEnemy();
            for(let i = 0; i < 5; i++) spawnItem();
        }

        function spawnEnemy() {
            enemies.push({
                x: Math.random() * gameWidth,
                y: Math.random() * gameHeight,
                size: 35,
                speed: 3,
                health: 100,
                angle: 0,
                lastUpdate: 0,
                cooldown: 2000
            });
        }

        function spawnItem() {
            items.push({
                x: Math.random() * (gameWidth - 30),
                y: Math.random() * (gameHeight - 30),
                type: Math.random() > 0.5 ? 'health' : 'ammo'
            });
        }

        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.size &&
                   rect1.x + rect1.size > rect2.x &&
                   rect1.y < rect2.y + rect2.size &&
                   rect1.y + rect1.size > rect2.y;
        }

        function handlePickup() {
            items.forEach((item, index) => {
                const dx = item.x - player.x;
                const dy = item.y - player.y;
                const distance = Math.sqrt(dx*dx + dy*dy);
                
                if(distance < player.pickupRadius) {
                    if(item.type === 'health') {
                        player.health = Math.min(100, player.health + 30);
                        healthSpan.textContent = player.health;
                    }
                    else if(item.type === 'ammo') {
                        player.ammo += 15;
                        ammoSpan.textContent = player.ammo;
                    }
                    items.splice(index, 1);
                    spawnItem();
                }
            });
        }

        function drawPlayer() {
            ctx.save();
            ctx.translate(player.x + player.size/2, player.y + player.size/2);
            ctx.rotate(player.angle);
            
            // Тело
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(0, 0, player.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Ствол
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(player.size/4, -3, player.size/2, 6);
            
            ctx.restore();
        }

        function drawEnemy(enemy) {
            ctx.save();
            ctx.translate(enemy.x + enemy.size/2, enemy.y + enemy.size/2);
            ctx.rotate(enemy.angle);
            
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(0, 0, enemy.size/2, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#c0392b';
            ctx.beginPath();
            ctx.moveTo(enemy.size/2, 0);
            ctx.lineTo(-enemy.size/4, -enemy.size/4);
            ctx.lineTo(-enemy.size/4, enemy.size/4);
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
        }

        function drawPickupRadius() {
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.arc(
                player.x + player.size/2,
                player.y + player.size/2,
                player.pickupRadius,
                0,
                Math.PI * 2
            );
            ctx.stroke();
        }

        function gameLoop() {
            // Движение игрока
            if(keys.w) player.y -= player.speed;
            if(keys.a) { 
                player.x -= player.speed;
                player.angle = -Math.PI/2;
            }
            if(keys.s) player.y += player.speed;
            if(keys.d) {
                player.x += player.speed;
                player.angle = Math.PI/2;
            }

            // Обновление пуль
            bullets.forEach((bullet, index) => {
                bullet.x += bullet.speedX;
                bullet.y += bullet.speedY;
                
                // Проверка попадания во врагов
                enemies.forEach((enemy, enemyIndex) => {
                    if(checkCollision(bullet, enemy)) {
                        enemies.splice(enemyIndex, 1);
                        bullets.splice(index, 1);
                        spawnEnemy();
                    }
                });
            });

            // Движение врагов
            enemies.forEach(enemy => {
                const dx = player.x - enemy.x;
                const dy = player.y - enemy.y;
                const distance = Math.sqrt(dx*dx + dy*dy);
                
                enemy.angle = Math.atan2(dy, dx);
                enemy.x += (dx/distance) * enemy.speed;
                enemy.y += (dy/distance) * enemy.speed;

                // Проверка столкновения с игроком
                if(checkCollision(player, enemy)) {
                    player.health -= 0.5;
                    healthSpan.textContent = Math.floor(player.health);
                }
            });

            // Отрисовка
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Игрок
            drawPlayer();
            
            // Враги
            enemies.forEach(drawEnemy);
            
            // Пули
            ctx.fillStyle = 'black';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, 5, 5);
            });
            
            // Предметы
            items.forEach(item => {
                ctx.fillStyle = item.type === 'health' ? '#2ecc71' : '#f1c40f';
                ctx.beginPath();
                ctx.arc(item.x + 15, item.y + 15, 15, 0, Math.PI * 2);
                ctx.fill();
            });
            
            drawPickupRadius();

            // Проверка смерти
            if(player.health <= 0) {
                cancelAnimationFrame(animationFrame);
                alert('Game Over!');
                menu.style.display = 'flex';
                gameContainer.style.display = 'none';
            }

            animationFrame = requestAnimationFrame(gameLoop);
        }

        // Обработчики событий
        document.addEventListener('keydown', (e) => {
            switch(e.code) {
                case 'KeyW': keys.w = true; break;
                case 'KeyA': keys.a = true; break;
                case 'KeyS': keys.s = true; break;
                case 'KeyD': keys.d = true; break;
                case 'Space': 
                    if(player.ammo > 0) {
                        player.ammo--;
                        ammoSpan.textContent = player.ammo;
                        bullets.push({
                            x: player.x + player.size/2,
                            y: player.y + player.size/2,
                            speedX: Math.cos(player.angle) * 10,
                            speedY: Math.sin(player.angle) * 10,
                            size: 5
                        });
                    }
                    break;
                case 'KeyE': handlePickup(); break;
            }
        });

        document.addEventListener('keyup', (e) => {
            switch(e.code) {
                case 'KeyW': keys.w = false; break;
                case 'KeyA': keys.a = false; break;
                case 'KeyS': keys.s = false; break;
                case 'KeyD': keys.d = false; break;
            }
        });

        window.addEventListener('resize', () => {
            gameWidth = window.innerWidth;
            gameHeight = window.innerHeight;
            canvas.width = gameWidth;
            canvas.height = gameHeight;
        });
    </script>
</body>
</html>
